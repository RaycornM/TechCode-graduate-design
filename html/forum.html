<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>论坛页面</title>
  <link rel="stylesheet" href="../css/forum.css" />
  <link rel="stylesheet" href="../css/left-right-bg-text.css" />
  <link rel="stylesheet" href="../css/copyright.css" />
  <link rel="stylesheet" href="../css/top1.css" />
  <link rel="stylesheet" href="../css/navbar.css" />
  <link rel="stylesheet" href="../css/foot.css" />
  <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@1,700&display=swap" rel="stylesheet">
  <link href="../font-awesome/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../highlight/styles/railscasts.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <style>

  </style>
</head>

<body>

  <body tabindex="-1">
    <div class="edison-header">
      <div class="container">
        <div class="header-inner-wrap">
          <div class="logo">
            <span class="wsite-logo">
              <a href="/">
                <span id="wsite-title">TECH CODE</span>
              </a>
            </span>
          </div>
          <div class="nav-wrap">
            <div class="nav desktop-nav">
              <ul class="wsite-menu-default">
                <li id="active" class="wsite-menu-item-wrap">
                  <a href="/" class="wsite-menu-item">
                    主页
                  </a>
                </li>
                <li id="pg695107136787074782" class="wsite-menu-item-wrap has-submenu">
                  <a href="/product" class="wsite-menu-item">
                    产品
                  </a>
                  <div class="wsite-menu-wrap">
                    <ul class="wsite-menu">
                      <li id="pg695107136787074782" class="wsite-menu-subitem-wrap">
                        <a href="/product" class="wsite-menu-subitem">
                          产品
                        </a>
                      </li>
                      <li id="wsite-nav-656255702513029941" class="wsite-menu-subitem-wrap">
                        <a href="/compare" class="wsite-menu-item">
                          <span class="wsite-menu-title">
                            对比
                          </span>
                        </a>
                      </li>
                    </ul>
                  </div>
                </li>
                <li id="pg686450546927473873" class="wsite-menu-item-wrap">
                  <a href="/evaluation" class="wsite-menu-item">
                    测评
                  </a>
                </li>
                <li id="pg103030197960015510" class="wsite-menu-item-wrap">
                  <a href="/3616435759.html" class="wsite-menu-item">
                    资讯
                  </a>
                </li>
                <li id="pg881371934255644335" class="wsite-menu-item-wrap">
                  <a href="/forum" class="wsite-menu-item">
                    论坛
                  </a>
                </li>
                <li id="pg140230651504229610" class="wsite-menu-item-wrap">
                  <a href="/login_register" class="wsite-menu-item">
                    注册
                  </a>
                </li>
                <li id="pg190149529979835302" class="wsite-menu-item-wrap">
                  <a href="/login_register" class="wsite-menu-item">
                    登录
                  </a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="wsite-spacer" style="height:60px;"></div>
    <header>
      <h1>TechCode论坛</h1>
    </header>
    <div id="search-container">
      <input type="text" id="search" placeholder="搜索帖子">
    </div>
    <div id="forum-page">
      <div id="forum-container">
        <div id="forum-posts"></div>
        <form id="create-post-form">
          <input type="text" id="post-title" placeholder="标题" required>
          <input type="text" id="post-author" placeholder="作者" required>
          <button type="submit">发新帖</button>
        </form>
        <div id="posts-container"></div>
      </div>
    </div>
    <div id="pagination">
      <!-- 分页链接在这里显示 -->
    </div>
    <footer>
      <div class="footcontent">
        <div class="footer-wrapper">
          <h4 class="footer-title">Quick Link</h4>
          <ul class="footer-menu footer-2-menu">
            <li><a href="#">关于</a></li>
            <li><a href="/product">产品</a></li>
            <li><a href="/evaluation">测评</a></li>
            <li><a href="#">资讯</a></li>
            <li><a href="/forum">论坛</a></li>
            <li><a href="#">我的</a></li>
            <li><a href="#">帮助和支持</a></li>
          </ul>
        </div>
        <div class="subscription">
          <div>
            <h4 class="dingyuetit">订阅我们</h4>
            <p></p>
            <p></p>
            <div class="subscription-input-wrapper">
              <input type="email" name="輸入你的郵箱*" required="" placeholder="輸入你的郵箱*" id="comp-jucjyt59input" value=""
                class="sub">
              <a href="index.html">
                <button2 class="button2" type="button">現在訂閲</button2>
              </a>
            </div>
            <img class="subcon" src="img/connect.png">
          </div>
          <div></div>
        </div>
        </p>
        <div class="contact-wrapper">
          <div>
            <h4 class="footer-title">联系我们</h4>
            <ul class="footer-link">
              <li>广州工商学院, 三水校区 <br> 广东，中国
              </li>
              <li><a href="/cdn-cgi/l/email-protection" class="__cf_email__"
                  data-cfemail="1e7f7a7377705e7b667f736e727b307d7173">[email&#160;protected]</a>
              </li>
              <li>114- 5141919810</li>
            </ul>
          </div>
        </div>
      </div>
    </footer>
    </div>
    <div class="copyright">
      <p class="bs">&copy; 2023 by TechCode. Proudly created by Deng Yumin</p>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      let currentPage = 1;
      const postsPerPage = 10;

      $(document).ready(function () {
        loadPosts(currentPage);

        $('#pagination').on('click', 'a', function (e) {
          e.preventDefault();
          currentPage = parseInt($(this).data('page'));
          loadPosts(currentPage);
        });
      });

      $('#login-form').on('submit', function (e) {
        e.preventDefault();

        const email = $('#email').val();
        const password = $('#password').val();

        $.post('/api/login', { email, password }, function (data) {
          // 登录成功，重定向到论坛页面
          window.location.href = '/forum';
        }).fail(function (xhr) {
          alert('登录失败，请检查您的电子邮件和密码。');
        });
      });

      function loadPosts(page) {
        $.get(`/api/posts?page=${page}&limit=${postsPerPage}`, function (data) {
          const posts = data.posts;
          console.log(data)
          const totalPages = data.totalPages;

          displayPosts(posts);
          displayPagination(totalPages);
        });
      }

      function displayPosts(posts) {
        let html = '';
        posts.forEach((post) => {
          html += `
      <div class="post">
        <h2 class="post-title">${post.title}</h2>
        <p class="post-info">作者：${post.author} | 发布日期：${post.date}</p>
        <a href="/post?id=${post.id}">查看详情</a>
      </div>
    `;
        });
        $('#forum-posts').html(html);
      }

      function displayPagination(totalPages) {
        let html = '';
        if (currentPage > 1) {
          html += `<a href="#" class="prev" data-page="${currentPage - 1}">&lt;</a>`;
        } else {
          html += `<span class="prev disabled">&lt;</span>`;
        }

        for (let i = 1; i <= totalPages; i++) {
          if (i === currentPage) {
            html += `<a href="#" class="active" data-page="${i}">${i}</a>`;
          } else {
            html += `<a href="#" data-page="${i}">${i}</a>`;
          }
        }

        if (currentPage < totalPages) {
          html += `<a href="#" class="next" data-page="${currentPage + 1}">&gt;</a>`;
        } else {
          html += `<span class="next disabled">&gt;</span>`;
        }

        $('#pagination').html(html);
      }
    </script>
  </body>
</body>

</html>
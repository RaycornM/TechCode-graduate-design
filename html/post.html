<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>帖子页面</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/emoji-picker/1.0.0/css/jquery.emojipicker.css">
</head>
<body>
  <div class="edison-header">
    <div class="container">
      <div class="header-inner-wrap">
        <div class="logo">
          <span class="wsite-logo">
            <a href="/">
              <span id="wsite-title">TECH CODE</span>
            </a>
          </span>
        </div>
        <div class="nav-wrap">
          <div class="dummy-menu">
            <ul class="wsite-menu-default">
              <li id="active" class="wsite-menu-item-wrap    wsite-nav-1" style="position: relative;">
                <a href="/" class="wsite-menu-item" style="position: relative;">
                  主页
                </a>
              </li>
              <li id="pg695107136787074782" class="wsite-menu-item-wrap has-submenu   wsite-nav-2"
                style="position: relative;">
                <a href="/product" class="wsite-menu-item" style="position: relative;">
                  产品
                </a>
              </li>
              <li id="pg686450546927473873" class="wsite-menu-item-wrap    wsite-nav-3" style="position: relative;">
                <a href="/evaluation" class="wsite-menu-item" style="position: relative;">
                  测评
                </a>
              </li>
              <li id="pg103030197960015510" class="wsite-menu-item-wrap    wsite-nav-4" style="position: relative;">
                <a href="/3616435759.html" class="wsite-menu-item" style="position: relative;">
                  资讯
                </a>
              </li>
              <li id="pg881371934255644335" class="wsite-menu-item-wrap    wsite-nav-5" style="position: relative;">
                <a href="/forum" class="wsite-menu-item" style="position: relative;">
                  论坛
                </a>
              </li>
              <li id="pg140230651504229610" class="wsite-menu-item-wrap    wsite-nav-6" style="position: relative;">
                <a href="/login_register" class="wsite-menu-item" style="position: relative;">
                  注册
                </a>
              </li>
              <li id="pg190149529979835302" class="wsite-menu-item-wrap    wsite-nav-7" style="position: relative;">
                <a href="/login_register" class="wsite-menu-item" style="position: relative;">
                  登录
                </a>
              </li>
            </ul>
          </div>
          <div class="nav desktop-nav">
            <ul class="wsite-menu-default">
              <li id="active" class="wsite-menu-item-wrap ">
                <a href="/" class="wsite-menu-item">
                  主页
                </a>
              </li>
              <li id="pg695107136787074782" class="wsite-menu-item-wrap has-submenu">
                <a href="/product" class="wsite-menu-item">
                  产品
                </a>
                <div class="wsite-menu-wrap" style="display:none">
                  <ul class="wsite-menu">
                    <li id="pg695107136787074782" class="wsite-menu-subitem-wrap cloned-link">
                      <a href="/product" class="wsite-menu-subitem">
                        产品
                      </a>
                    </li>
                    <li id="wsite-nav-656255702513029941" class="wsite-menu-subitem-wrap  ">
                      <a href="/compare" class="wsite-menu-item">
                        <span class="wsite-menu-title">
                          对比
                        </span>
                      </a>

                    </li>

                  </ul>
                </div>

              </li>
              <li id="pg686450546927473873" class="wsite-menu-item-wrap ">
                <a href="/evaluation" class="wsite-menu-item">
                  测评
                </a>

              </li>
              <li id="pg103030197960015510" class="wsite-menu-item-wrap ">
                <a href="/3616435759.html" class="wsite-menu-item">
                  资讯
                </a>

              </li>
              <li id="pg881371934255644335" class="wsite-menu-item-wrap ">
                <a href="/forum" class="wsite-menu-item">
                  论坛
                </a>

              </li>
              <li id="pg140230651504229610" class="wsite-menu-item-wrap ">
                <a href="/login_register" class="wsite-menu-item">
                  注册
                </a>

              </li>
              <li id="pg190149529979835302" class="wsite-menu-item-wrap ">
                <a href="/login_register" class="wsite-menu-item">
                  登录
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  <h1>帖子页面</h1>
  <div id="post-content">
    <!-- 帖子内容在这里显示 -->
  </div>
  <div id="comments">
    <!-- 评论内容在这里显示 -->
  </div>
  <form id="comment-form">
    <input type="hidden" id="parent-comment-id" value="">
    <textarea id="comment-text" placeholder="写下你的评论..."></textarea>
    <button type="submit">发表评论</button>
  </form>
  <footer>
    <div class="footcontent">
      <div class="footer-wrapper">
        <h4 class="footer-title">Quick Link</h4>
        <ul class="footer-menu footer-2-menu">
          <li><a href="#">关于</a></li>
          <li><a href="/product">产品</a></li>
          <li><a href="/evaluation">测评</a></li>
          <li><a href="#">资讯</a></li>
          <li><a href="/forum">论坛</a></li>
          <li><a href="#">我的</a></li>
          <li><a href="#">帮助和支持</a></li>
        </ul>
      </div>
      <div class="subscription">
        <div>
          <h4 class="dingyuetit">订阅我们</h4>
          <p></p>
          <p></p>
          <div class="subscription-input-wrapper">
            <input type="email" name="輸入你的郵箱*" required="" placeholder="輸入你的郵箱*" id="comp-jucjyt59input" value=""
              class="sub">
            <a href="index.html">
              <button2 class="button2" type="button">現在訂閲</button2>
            </a>
          </div>
          <img class="subcon" src="img/connect.png">
        </div>
        <div></div>
      </div>
      </p>
      <div class="contact-wrapper">
        <div>
          <h4 class="footer-title">联系我们</h4>
          <ul class="footer-link">
            <li>广州工商学院, 三水校区 <br> 广东，中国
            </li>
            <li><a href="/cdn-cgi/l/email-protection" class="__cf_email__"
                data-cfemail="1e7f7a7377705e7b667f736e727b307d7173">[email&#160;protected]</a>
            </li>
            <li>114- 5141919810</li>
          </ul>
        </div>
      </div>
    </div>
  </footer>
  </div>
  <div class="copyright">
    <p class="bs">&copy; 2023 by TechCode. Proudly created by Deng Yumin</p>
  </div>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/emoji-picker/1.0.0/jquery.emojipicker.min.js"></script>
  <script>
    const postId = getPostIdFromUrl(); // 从URL中获取帖子ID

    $(document).ready(function () {
      loadPost(postId);
      loadComments(postId);

      $('#comment-form').on('submit', function (e) {
        e.preventDefault();
        const text = $('#comment-text').val();
        const parentCommentId = $('#parent-comment-id').val();
        submitComment(postId, text, parentCommentId);
      });

      $('#comments').on('click', '.reply-button', function () {
        const parentCommentId = $(this).data('id');
        $('#parent-comment-id').val(parentCommentId);
      });
    });

    function loadPost(postId) {
      $.get(`/api/posts/${postId}`, function (post) {
        const html = `
          <h2>${post.title}</h2>
          <p>${post.content}</p>
        `;
        $('#post-content').html(html);
      });
    }

    function loadComments(postId) {
      $.get(`/api/posts/${postId}/comments`, function (comments) {
        displayComments(comments);
      });
    }

    function displayComments(comments) {
      let html = '';
      comments.forEach((comment) => {
        html += `
          <div class="comment" data-id="${comment.id}">
            <h3>${comment.author}</h3>
            <p>${comment.text}</p>
            <button class="reply-button" data-id="${comment.id}">回复</button>
          </div>
        `;
      });
      $('#comments').html(html);
    }

    function submitComment(postId, text, parentCommentId) {
      $.post('/api/comments', { postId, text, parentCommentId }, function () {
        $('#comment-text').val('');
        $('#parent-comment-id').val('');
        loadComments(postId);
      });
    }

    function getPostIdFromUrl() {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get('id');
    }
  </script>
</body>
</html>